# 📚11. 📌(중요) 로그 콜백 수신 데이터 형식 (0x00 0x0C Log callback parameters)

이 항목은 프린터가 실시간으로 전달하는 **로그 콜백 데이터의 구조**를 정의한다. `0x00 0x09` 명령으로 로그 콜백이 등록된 이후, 프린터가 클라이언트에 전송하는 콜백 메시지는 이 형식을 따른다.

---

## ✅ 왜 콜백 핸들링(0x00 0x0C)이 필요한가?

### 💡문제 상황

- 내가 코드 이미지 데이터를 전송했다고 해도 **프린터가 실제로 인쇄를 끝냈는지** 모르면:
    
    - 다음 데이터 전송 타이밍을 예측하기 어려움
        
    - 과도하게 빠르게 보내면 캐시 오버
        
    - 느리게 보내면 비효율

### 🔹인쇄 완료 시점을 모르면 타이밍 제어 어려움

- 프린터가 **"나는 아직 전 건 인쇄도 못했는데"** 상황인데 다음 이미지가 오면 또 캐시 초과
---

### 👍대응 방법

- `0x00 0x0C` 명령을 통해 **인쇄 완료 콜백을 등록**하면:
    
    - 프린터가 **1건 인쇄 완료될 때마다** PC로 메시지를 보내줌
        
    - 콜백 수신 후 → 다음 전송 시작
        
- 이렇게 하면 **정확하게 “1물 1코드 전송-인쇄 완료 확인-다음 전송” 루프를 안정적으로 구현**가능
  
  

## ✅ 수신 메시지(Response)

- **헤더(Header)**: `0xEB 0x01`
    
- **프로토콜 마크**: `0x00 0x0C`
    
- **데이터 길이**: 4바이트 (`�` 포함)
    
- **데이터**: JSON 문자열 (UTF-8)

### 📄 수신 JSON 예시:

```
{
  "group_id": 0,
  "index": 11343,
  "yield": 11343,
  "status": 0,
  "text": [
    {
      "metatype": 3,
      "metaname": "counter 1",
      "metadata": "1344"
    },
    {
      "metatype": 4,
      "metaname": "shift 1",
      "metadata": "S1"
    }
  ]
}
```

### ✅ 주요 필드 설명

| 필드명      | 설명                                                              |
| -------- | --------------------------------------------------------------- |
| group_id | 프린트 헤드 그룹 ID                                                    |
| index    | 로그 인덱스 번호                                                       |
| yield    | 출력 수량 (누적 카운트)                                                  |
| status   | 상태 (0: 인쇄 완료, 1: 덮어쓰기됨)                                         |
| text     | 인쇄된 각 항목 정보 배열. 각 항목은 `metatype`, `metaname`, `metadata` 포함     |
| metatype | 전달된 데이터가 어떤 종류의 데이터인지를 구분하기 위한 타입 코드<br>( 코드 값에 대한 설명은 문서 없었음 ) |
| metaname | 데이터 소스의 이름 (예: "counter 1", "shift 1")                          |
| metadata | 전송된 실제 내용 (예: "1344", "S1")                                     |

---

## ✅ 요약

- 로그 콜백 수신 시 프린터에서 자동 전송되는 데이터 포맷
    
- 출력 수량, 데이터 항목들, 프린트 그룹 등의 정보 포함
    
- 이 0x00 0x0C (로그 콜백 수신 데이터 형식) API는 클라이언트가 프린터의 인쇄 작업 및 상태 변화에 대한 실시간 피드백을 받을 수 있도록 한다.
  
  따라서 생산 추적, 실시간 품질 모니터링 기능을 구현할 때 사용하면 좋을 것으로 추측된다.

---